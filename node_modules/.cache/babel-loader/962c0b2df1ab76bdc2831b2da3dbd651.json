{"ast":null,"code":"import _regeneratorRuntime from\"/Users/softnotions/Desktop/poumki/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/softnotions/Desktop/poumki/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/softnotions/Desktop/poumki/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import axios from\"axios\";import{Draw}from\"./Draw\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Image=function Image(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),selectedFile=_useState2[0],setSelectedFile=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],setImage=_useState6[1];var sendRequest=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"http://localhost:3001/s3url\").catch(function(err){return console.log(err);});case 2:res=_context.sent;_context.next=5;return res.data;case 5:data=_context.sent;// console.log(data.url);\nsetData(data.url);return _context.abrupt(\"return\",data);case 8:case\"end\":return _context.stop();}}},_callee);}));return function sendRequest(){return _ref.apply(this,arguments);};}();useEffect(function(){sendRequest();},[]);var fileSelectorHandler=function fileSelectorHandler(event){setSelectedFile(event.target.files[0]);console.log(event.target.files[0]);if(event.target.files&&event.target.files[0]){setImage(URL.createObjectURL(event.target.files[0]));}};var FileUploadHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var file,upload,imageUrl;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:file=selectedFile;if(data!==\"\"){upload=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.put(data,{method:\"PUT\",headers:{\"Content-Type\":\"multipart/form-data\"},body:file});case 2:res=_context2.sent;alert(\"Photo uploaded to S3\");case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function upload(){return _ref3.apply(this,arguments);};}();upload();imageUrl=data.split(\"?\")[0];}case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function FileUploadHandler(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"image-div\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"selection-div\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",type:\"file\",id:\"imageInput\",accept:\"image/*\",onChange:fileSelectorHandler})})}),/*#__PURE__*/_jsx(\"div\",{className:\"image-display mt-2\",children:image&&/*#__PURE__*/_jsx(Draw,{data:image})})]});};","map":{"version":3,"names":["useState","useEffect","axios","Draw","Image","selectedFile","setSelectedFile","data","setData","image","setImage","sendRequest","get","catch","err","console","log","res","url","fileSelectorHandler","event","target","files","URL","createObjectURL","FileUploadHandler","file","upload","put","method","headers","body","alert","imageUrl","split"],"sources":["/Users/softnotions/Desktop/poumki/client/src/image/Image.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { Draw } from \"./Draw\";\n\nexport const Image = () => {\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [data, setData] = useState(\"\");\n  const [image, setImage] = useState(null);\n\n  const sendRequest = async () => {\n    const res = await axios\n      .get(\"http://localhost:3001/s3url\")\n      .catch((err) => console.log(err));\n    const data = await res.data;\n    // console.log(data.url);\n    setData(data.url);\n    return data;\n  };\n\n  useEffect(() => {\n    sendRequest();\n  }, []);\n\n  const fileSelectorHandler = (event) => {\n    setSelectedFile(event.target.files[0]);\n    console.log(event.target.files[0]);\n    if (event.target.files && event.target.files[0]) {\n      setImage(URL.createObjectURL(event.target.files[0]));\n    }\n  };\n\n  const FileUploadHandler = async () => {\n\n    const file = selectedFile;\n\n    if (data !== \"\") {\n      const upload = async () => {\n        const res = await axios.put(data, {\n          method: \"PUT\",\n          headers: {\n            \"Content-Type\": \"multipart/form-data\",\n          },\n          body: file,\n        });\n        alert(\"Photo uploaded to S3\");\n      };\n      upload();\n      const imageUrl = data.split(\"?\")[0];\n    }\n\n  };\n\n  return (\n    <div className=\"image-div\">\n      <div className=\"selection-div\">\n        <div>\n          <input\n            className=\"form-control\"\n            type=\"file\"\n            id=\"imageInput\"\n            accept=\"image/*\"\n            onChange={fileSelectorHandler}\n          />\n        </div>\n        {/* <div className=\"right-div\">\n          <button onClick={FileUploadHandler}>Upload</button>\n          <a href={image} download={image}>\n            <button>Download</button>\n          </a>\n        </div> */}\n      </div>\n\n      <div className=\"image-display mt-2\">{image && <Draw data={image} />}</div>\n    </div>\n  );\n};"],"mappings":"0YAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,MAAOC,MAAP,KAAkB,OAAlB,CACA,OAASC,IAAT,KAAqB,QAArB,C,wFAEA,MAAO,IAAMC,MAAK,CAAG,QAARA,MAAQ,EAAM,CACzB,cAAwCJ,QAAQ,CAAC,IAAD,CAAhD,wCAAOK,YAAP,eAAqBC,eAArB,eACA,eAAwBN,QAAQ,CAAC,EAAD,CAAhC,yCAAOO,IAAP,eAAaC,OAAb,eACA,eAA0BR,QAAQ,CAAC,IAAD,CAAlC,yCAAOS,KAAP,eAAcC,QAAd,eAEA,GAAMC,YAAW,4FAAG,wKACAT,MAAK,CACpBU,GADe,CACX,6BADW,EAEfC,KAFe,CAET,SAACC,GAAD,QAASC,QAAO,CAACC,GAAR,CAAYF,GAAZ,CAAT,EAFS,CADA,QACZG,GADY,qCAICA,IAAG,CAACV,IAJL,QAIZA,IAJY,eAKlB;AACAC,OAAO,CAACD,IAAI,CAACW,GAAN,CAAP,CANkB,gCAOXX,IAPW,wDAAH,kBAAXI,YAAW,0CAAjB,CAUAV,SAAS,CAAC,UAAM,CACdU,WAAW,GACZ,CAFQ,CAEN,EAFM,CAAT,CAIA,GAAMQ,oBAAmB,CAAG,QAAtBA,oBAAsB,CAACC,KAAD,CAAW,CACrCd,eAAe,CAACc,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAAD,CAAf,CACAP,OAAO,CAACC,GAAR,CAAYI,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAAZ,EACA,GAAIF,KAAK,CAACC,MAAN,CAAaC,KAAb,EAAsBF,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAA1B,CAAiD,CAC/CZ,QAAQ,CAACa,GAAG,CAACC,eAAJ,CAAoBJ,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAApB,CAAD,CAAR,CACD,CACF,CAND,CAQA,GAAMG,kBAAiB,6FAAG,mKAElBC,IAFkB,CAEXrB,YAFW,CAIxB,GAAIE,IAAI,GAAK,EAAb,CAAiB,CACToB,MADS,6FACA,yKACKzB,MAAK,CAAC0B,GAAN,CAAUrB,IAAV,CAAgB,CAChCsB,MAAM,CAAE,KADwB,CAEhCC,OAAO,CAAE,CACP,eAAgB,qBADT,CAFuB,CAKhCC,IAAI,CAAEL,IAL0B,CAAhB,CADL,QACPT,GADO,gBAQbe,KAAK,CAAC,sBAAD,CAAL,CARa,wDADA,kBACTL,OADS,4CAWfA,MAAM,GACAM,QAZS,CAYE1B,IAAI,CAAC2B,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAZF,CAahB,CAjBuB,wDAAH,kBAAjBT,kBAAiB,2CAAvB,CAqBA,mBACE,aAAK,SAAS,CAAC,WAAf,wBACE,YAAK,SAAS,CAAC,eAAf,uBACE,kCACE,cACE,SAAS,CAAC,cADZ,CAEE,IAAI,CAAC,MAFP,CAGE,EAAE,CAAC,YAHL,CAIE,MAAM,CAAC,SAJT,CAKE,QAAQ,CAAEN,mBALZ,EADF,EADF,EADF,cAmBE,YAAK,SAAS,CAAC,oBAAf,UAAqCV,KAAK,eAAI,KAAC,IAAD,EAAM,IAAI,CAAEA,KAAZ,EAA9C,EAnBF,GADF,CAuBD,CAvEM"},"metadata":{},"sourceType":"module"}